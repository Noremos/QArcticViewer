@ Вычислить корректную высоту с учётом фактора
calcPos()
#d desktop

    mat4 rmat = model;
    vec3 vp = a_position;
    v_pos = vp;
//    vp.y *= factor;
//    rmat[1][1] *= factor;
    vp.y = minHei + (vp.y - minHei) * factor;
    gl_Position = projection * view * rmat  * vec4(vp, 1.0);

#m mobile

@ Вставить униформы высота, проекция и вид
uniform MPV;
#d

uniform mat4 model;
uniform mat4 projection;
uniform mat4 view;

@ Вставить импорт. @1 - тип (vec3) @2 - название, [@name] - передать переменной вывода (создать её)
import @1 @2 [putToEnd 'out_{@2} = @2;' | initOut 'out_{@2};']
#d

layout(location = 0) in vec3 a_position;